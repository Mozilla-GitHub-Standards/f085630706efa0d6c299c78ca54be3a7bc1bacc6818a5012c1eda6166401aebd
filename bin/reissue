#!/bin/bash

BIN="$( cd "$( dirname "${BASH_SOURCE[0]}" )" && pwd )"

BASE="tercotua.org"

#two random words
ONE=`shuf -n1 /usr/share/dict/words`
TWO=`shuf -n1 /usr/share/dict/words`

#trim apostrophes
ONE="${ONE%\'*}"
TWO="${TWO%\'*}"

#lowercase and add tercotua domain
COMMON_NAME="${ONE,,}-${TWO,,}.$BASE"

cmd="$BIN/autocert create $COMMON_NAME -b -o c --sans n1.$BASE n2.$BASE $@"
echo $cmd
exec $cmd

cmd="$BIN/autocert reissue $COMMON_NAME -b -o c --sans n3.$BASE $@"
echo $cmd
exec $cmd
